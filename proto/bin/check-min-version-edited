#!/bin/bash -e

if ! buf breaking --against "https://github.com/pubgolf/pubgolf.git#branch=${1}" ; then 
  echo 'Found breaking changes in proto definition. Checking version constants...'
  proto/bin/check-file-edited "refs/remotes/origin/${1}" HEAD 'proto/versions/mincompatible/go/version.go';
  echo 'All version constants have been updated.'
fi
